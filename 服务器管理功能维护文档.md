# 服务器管理功能维护文档

## 功能概述

服务器管理功能是僵尸网络接管与清除后台管理系统的一个组成部分，用于管理和监控系统中的服务器资源。该功能允许管理员查看、添加、编辑和删除服务器信息，包括地理位置、IP地址、域名、链路状态和操作系统等关键信息。

## 系统架构

### 后端实现

1. **数据库表结构**：
   - 表名：`Server_Management`
   - 字段：
     - `id`: INT, 自增主键
     - `location`: VARCHAR(255), 地理位置
     - `ip`: VARCHAR(50), IP地址
     - `domain`: VARCHAR(255), 域名
     - `status`: VARCHAR(50), 链路状态
     - `os`: VARCHAR(100), 操作系统
     - `created_at`: TIMESTAMP, 创建时间
     - `updated_at`: TIMESTAMP, 更新时间

2. **API接口**：
   - 基础路径：`/api/server`
   - 获取服务器列表：`GET /api/server/servers`
   - 获取单个服务器：`GET /api/server/servers/{server_id}`
   - 创建服务器：`POST /api/server/servers`
   - 更新服务器：`PUT /api/server/servers/{server_id}`
   - 删除服务器：`DELETE /api/server/servers/{server_id}`

3. **文件结构**：
   - 路由定义：`backend/router/server.py`
   - 路由注册：在`backend/main.py`中注册

### 前端实现

1. **组件**：
   - 服务器管理组件：`fronted/src/components/ServerManagement.js`
   - 导航菜单项：在`fronted/src/components/adminPage.js`中定义

2. **服务**：
   - API调用服务：`fronted/src/services/index.js`中的服务器管理相关函数

3. **功能**：
   - 服务器列表展示（支持分页）
   - 添加新服务器
   - 编辑现有服务器
   - 删除服务器
   - 按状态筛选服务器

## 维护指南

### 数据库维护

1. **表创建**：
   - 表会在后端服务器首次启动时自动创建
   - 如需手动创建，可执行以下SQL：
   ```sql
   CREATE TABLE Server_Management (
       id INT AUTO_INCREMENT PRIMARY KEY,
       location VARCHAR(255) NOT NULL,
       ip VARCHAR(50) NOT NULL,
       domain VARCHAR(255) NOT NULL,
       status VARCHAR(50) NOT NULL,
       os VARCHAR(100) NOT NULL,
       created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
       updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
   )
   ```

2. **数据备份**：
   - 建议定期备份服务器管理数据
   - 可使用以下命令导出数据：
   ```bash
   mysqldump -u root -p botnet Server_Management > server_management_backup.sql
   ```

### 后端维护

1. **添加新字段**：
   - 在`server.py`中的`ServerModel`和`CreateServerRequest`类中添加新字段
   - 修改数据库表结构
   - 更新相关的CRUD操作函数

2. **修改API逻辑**：
   - 所有API处理逻辑都在`server.py`文件中
   - 修改后需重启后端服务器

3. **错误排查**：
   - 检查日志输出
   - 验证数据库连接配置
   - 确认API路由是否正确注册

### 前端维护

1. **修改UI**：
   - 服务器管理页面的UI定义在`ServerManagement.js`中
   - 表格列定义在`columns`变量中
   - 表单定义在Modal组件内的Form中

2. **添加新功能**：
   - 在`ServerManagement.js`中添加新的状态变量和处理函数
   - 更新表格列和表单字段
   - 在`services/index.js`中添加或修改API调用函数

3. **样式调整**：
   - 组件使用styled-components定义样式
   - 可在`ServerManagement.js`顶部的样式定义部分进行修改

## 常见问题

1. **表不存在**：
   - 确认后端服务器已启动
   - 检查数据库连接配置
   - 可能需要手动创建表

2. **API调用失败**：
   - 检查网络连接
   - 确认API路径正确
   - 验证请求参数格式

3. **UI显示异常**：
   - 检查浏览器控制台错误
   - 确认数据格式是否符合预期
   - 验证样式是否正确应用

## 未来扩展

1. **监控功能**：
   - 添加服务器实时监控
   - 显示CPU、内存、磁盘使用率等指标

2. **批量操作**：
   - 支持批量添加、编辑、删除服务器

3. **高级筛选**：
   - 按多个条件组合筛选服务器
   - 支持模糊搜索

4. **权限控制**：
   - 基于角色的服务器管理权限
   - 操作审计日志

## 联系方式

如有任何问题或需要进一步的支持，请联系系统管理员或开发团队。
